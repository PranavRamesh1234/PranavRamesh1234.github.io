(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[134],{24:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5155),s=r(2115),l=r(283),i=r(5695);function o(){let{user:e,updateProfile:t}=(0,l.A)(),r=(0,i.useRouter)(),[o,u]=(0,s.useState)((null==e?void 0:e.full_name)||""),[n,d]=(0,s.useState)((null==e?void 0:e.phone_number)||""),[c,m]=(0,s.useState)((null==e?void 0:e.location)||""),[h,b]=(0,s.useState)(!1),[x,f]=(0,s.useState)("");(0,s.useEffect)(()=>{e?e.phone_number&&e.location&&r.push("/books"):r.push("/auth")},[e,r]);let g=async e=>{e.preventDefault(),b(!0),f("");try{await t({full_name:o,phone_number:n,location:c}),r.push("/books")}catch(e){f(e.message)}finally{b(!1)}};return e?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Complete Your Profile"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Please provide your contact information to continue"})]}),(0,a.jsxs)("form",{onSubmit:g,className:"space-y-6 bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Full Name"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{type:"text",id:"fullName",value:o,onChange:e=>u(e.target.value),required:!0,className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Phone Number"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{type:"tel",id:"phoneNumber",value:n,onChange:e=>d(e.target.value),required:!0,pattern:"[0-9]{10}",className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Location"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{type:"text",id:"location",value:c,onChange:e=>m(e.target.value),required:!0,className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})})]}),x&&(0,a.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:x}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:h?"Saving...":"Complete Profile"})})]})]})})}):null}},283:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>o});var a=r(5155),s=r(2115),l=r(2099);let i=(0,s.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[u,n]=(0,s.useState)(!0);(0,s.useEffect)(()=>{l.N.auth.getSession().then(e=>{let{data:{session:t}}=e;(null==t?void 0:t.user)?d(t.user.id):(o(null),n(!1))});let{data:{subscription:e}}=l.N.auth.onAuthStateChange((e,t)=>{(null==t?void 0:t.user)?d(t.user.id):(o(null),n(!1))});return()=>{e.unsubscribe()}},[]);let d=async e=>{try{let{data:t,error:r}=await l.N.from("profiles").select("*").eq("id",e).single();if(r)throw r;o(t)}catch(e){console.error("Error fetching user profile:",e),o(null)}finally{n(!1)}},c=async(e,t)=>{let{error:r}=await l.N.auth.signInWithPassword({email:e,password:t});if(r)throw r},m=async(e,t)=>{let{data:r,error:a}=await l.N.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});if(a)throw a;if(r.user){let{error:e}=await l.N.from("profiles").insert([{id:r.user.id,email:r.user.email,full_name:"",phone_number:"",location:""}]);if(e)throw e}},h=async()=>{let{error:e}=await l.N.auth.signOut();if(e)throw e},b=async e=>{if(!r)throw Error("No user logged in");let{error:t}=await l.N.from("profiles").update(e).eq("id",r.id);if(t)throw t;o(t=>t?{...t,...e}:null)};return(0,a.jsx)(i.Provider,{value:{user:r,loading:u,signIn:c,signUp:m,signOut:h,updateProfile:b},children:t})}function u(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2099:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(851).UU)("https://apbgdwgiqrzarwnicguu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwYmdkd2dpcXJ6YXJ3bmljZ3V1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDczOTYzMDgsImV4cCI6MjA2Mjk3MjMwOH0.jrWCdt10IvmdK5FJolNYUFAMBZAttwTqycgGXRj6Isw")},2219:(e,t,r)=>{Promise.resolve().then(r.bind(r,24))},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[851,441,684,358],()=>t(2219)),_N_E=e.O()}]);