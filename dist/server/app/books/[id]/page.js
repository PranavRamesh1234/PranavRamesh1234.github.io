(()=>{var e={};e.id=511,e.ids=[511],e.modules={1186:(e,t,r)=>{Promise.resolve().then(r.bind(r,56183))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19338:(e,t,r)=>{Promise.resolve().then(r.bind(r,64761))},22378:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var a=r(65239),s=r(48088),o=r(88170),i=r.n(o),l=r(30893),n={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);r.d(t,n);let d={children:["",{children:["books",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,56183)),"C:\\Coding\\Learner App\\bookmarketv2\\src\\app\\books\\[id]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"C:\\Coding\\Learner App\\bookmarketv2\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Coding\\Learner App\\bookmarketv2\\src\\app\\books\\[id]\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/books/[id]/page",pathname:"/books/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30922:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(43210);let s=a.forwardRef(function({title:e,titleId:t,...r},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56183:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Coding\\\\Learner App\\\\bookmarketv2\\\\src\\\\app\\\\books\\\\[id]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Coding\\Learner App\\bookmarketv2\\src\\app\\books\\[id]\\page.tsx","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64761:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(60687),s=r(43210);r(76051);var o=r(30474),i=r(85814),l=r.n(i),n=r(30922);let d=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}),c=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))});function u({params:e}){let[t,r]=(0,s.useState)(null),[i,u]=(0,s.useState)(!0),[m,x]=(0,s.useState)(null),[g,p]=(0,s.useState)(0),[h,b]=(0,s.useState)(!1),f=e=>{p(e)},k=()=>{b(!h)};return i?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):m||!t?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:m||"Book Not Found"}),(0,a.jsx)(l(),{href:"/books",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Back to Books"})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 p-8",children:[(0,a.jsx)("div",{className:"space-y-4",children:t.images&&t.images.length>0?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"relative aspect-[3/4] w-full overflow-hidden rounded-lg",children:[(0,a.jsx)(o.default,{src:t.images[g],alt:t.title,fill:!0,className:`object-cover transition-transform duration-300 cursor-zoom-in ${h?"scale-150":"scale-100"}`,onClick:k}),(0,a.jsx)("button",{onClick:k,className:"absolute bottom-4 right-4 p-2 bg-black/50 rounded-full text-white hover:bg-black/70 transition-colors",children:(0,a.jsx)(n.A,{className:"h-6 w-6"})})]}),t.images.length>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>{t?.images&&p(e=>0===e?t.images.length-1:e-1)},className:"absolute left-4 top-1/2 -translate-y-1/2 p-2 bg-black/50 rounded-full text-white hover:bg-black/70 transition-colors",children:(0,a.jsx)(d,{className:"h-6 w-6"})}),(0,a.jsx)("button",{onClick:()=>{t?.images&&p(e=>e===t.images.length-1?0:e+1)},className:"absolute right-4 top-1/2 -translate-y-1/2 p-2 bg-black/50 rounded-full text-white hover:bg-black/70 transition-colors",children:(0,a.jsx)(c,{className:"h-6 w-6"})})]}),t.images.length>1&&(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2 mt-4",children:t.images.map((e,r)=>(0,a.jsx)("button",{onClick:()=>f(r),className:`relative aspect-square rounded-lg overflow-hidden ${g===r?"ring-2 ring-blue-500":"opacity-70 hover:opacity-100"}`,children:(0,a.jsx)(o.default,{src:e,alt:`${t.title} - Thumbnail ${r+1}`,fill:!0,className:"object-cover"})},r))})]}):(0,a.jsx)("div",{className:"aspect-[3/4] w-full bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-400 dark:text-gray-500",children:"No image available"})})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t.title}),(0,a.jsxs)("p",{className:"mt-2 text-xl text-gray-600 dark:text-gray-300",children:["by ",t.author]})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:(0,a.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Price"}),(0,a.jsxs)("dd",{className:"mt-1 text-2xl font-bold text-blue-600 dark:text-blue-400",children:["â‚¹",t.price]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Condition"}),(0,a.jsx)("dd",{className:"mt-1 text-lg text-gray-900 dark:text-white capitalize",children:t.condition})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Year of Publication"}),(0,a.jsx)("dd",{className:"mt-1 text-lg text-gray-900 dark:text-white",children:t.year_of_publication})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Location"}),(0,a.jsx)("dd",{className:"mt-1 text-lg text-gray-900 dark:text-white",children:t.location})]})]})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Description"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-300 whitespace-pre-wrap",children:t.description})]}),t.seller&&(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Seller Information"}),(0,a.jsxs)("div",{className:"mt-4 flex items-center space-x-4",children:[t.seller.avatar_url?(0,a.jsx)("div",{className:"relative h-12 w-12",children:(0,a.jsx)(o.default,{src:t.seller.avatar_url,alt:t.seller.full_name||"Seller",fill:!0,className:"rounded-full object-cover"})}):(0,a.jsx)("div",{className:"h-12 w-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:(t.seller.full_name||t.seller.email||"?")[0].toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.seller.full_name||"Anonymous Seller"}),t.seller.location&&(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.seller.location})]})]})]})]})]})})})})}},70440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(31658);let s=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},74075:e=>{"use strict";e.exports=require("zlib")},76051:(e,t,r)=>{"use strict";r.d(t,{QY:()=>o,bp:()=>s,r3:()=>i,zy:()=>l});var a=r(16391);let s=async(e,t)=>{try{let r=[];for(let s of e.images){let e=s.name.split(".").pop(),o=`${Math.random()}.${e}`,i=`${t}/${o}`,{error:l}=await a.N.storage.from("book-images").upload(i,s);if(l)throw l;let{data:{publicUrl:n}}=a.N.storage.from("book-images").getPublicUrl(i);r.push(n)}let{data:s,error:o}=await a.N.from("books").insert([{title:e.title,author:e.author,description:e.description,price:e.price,condition:e.condition,year_of_publication:e.yearOfPublication,location:e.location,category:e.category,tags:e.tags,images:r,seller_id:t,status:"available",created_at:new Date().toISOString()}]).select().single();if(o)throw o;return s}catch(e){throw console.error("Error in addBook:",e),e}},o=async e=>{console.log("Fetching book with ID:",e);try{let{data:t,error:r}=await a.N.from("books").select(`
        *,
        seller:profiles!books_seller_id_fkey (
          id,
          email,
          full_name,
          location,
          phone_number,
          avatar_url
        )
      `).eq("id",e).single();if(r)throw console.error("Supabase error:",r),r;if(!t)throw console.error("No book found with ID:",e),Error("Book not found");return console.log("Book data:",t),t}catch(e){throw console.error("Error in getBook:",e),e}},i=async(e,t)=>{console.log("Updating book with data:",t);let{images:r,existingImages:s,yearOfPublication:o,...i}=t,l={...i,year_of_publication:o};if(r&&r.length>0){let{data:{user:e}}=await a.N.auth.getUser();if(!e)throw Error("User must be authenticated to update book images");let t=[];for(let s of r){let r=s.name.split(".").pop(),o=`${Math.random()}.${r}`,i=`${e.id}/${o}`,{error:l}=await a.N.storage.from("book-images").upload(i,s);if(l)throw l;let{data:{publicUrl:n}}=a.N.storage.from("book-images").getPublicUrl(i);t.push(n)}l.images=[...s||[],...t]}let{data:n,error:d}=await a.N.from("books").update(l).eq("id",e).select().single();if(d)throw console.error("Error updating book:",d),d;return n};async function l(e){try{let t=a.N.from("books").select("*").order("created_at",{ascending:!1}),r=e?.get("q");r&&(t=t.or(`title.ilike.%${r}%,author.ilike.%${r}%,description.ilike.%${r}%`));let s=e?.get("category");s&&(t=t.eq("category",s));let{data:o,error:i}=await t;if(i)throw i;return o||[]}catch(e){throw console.error("Error fetching books:",e),e}}},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,406,658,927],()=>r(22378));module.exports=a})();